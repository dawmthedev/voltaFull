"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.UseType = void 0;
const schema_1 = require("@tsed/schema");
const paramFn_js_1 = require("./paramFn.js");
function shouldFallBackToAny(entity) {
    if (entity.itemSchema.has("allOf") || entity.itemSchema.has("anyOf") || entity.itemSchema.has("oneOf")) {
        return false;
    }
    return entity.isCollection && entity.type === Object && [undefined, "object"].includes(entity.itemSchema.get("type"));
}
/**
 * Set the type of the item collection.
 *
 * Prefer @@CollectionOf@@ usage.
 *
 * @param useType
 * @decorator
 * @operation
 * @input
 * @alias CollectionOf
 */
function UseType(useType) {
    return (0, paramFn_js_1.ParamFn)((entity, parameters) => {
        if (useType) {
            return (0, schema_1.CollectionOf)(useType);
        }
        if (shouldFallBackToAny(entity)) {
            (0, schema_1.Any)()(...parameters);
        }
    });
}
exports.UseType = UseType;
//# sourceMappingURL=useType.js.map