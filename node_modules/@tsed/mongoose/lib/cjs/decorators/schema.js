"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.MongooseSchema = exports.Schema = void 0;
const core_1 = require("@tsed/core");
const di_1 = require("@tsed/di");
const schema_1 = require("@tsed/schema");
const constants_js_1 = require("../constants/constants.js");
const createSchema_js_1 = require("../utils/createSchema.js");
function Schema(options = {}) {
    return (...parameters) => {
        switch ((0, core_1.decoratorTypeOf)(parameters)) {
            case "property":
                return (0, core_1.useDecorators)((0, schema_1.Property)(), (0, core_1.StoreMerge)(constants_js_1.MONGOOSE_SCHEMA, options))(parameters[0], parameters[1], parameters[2]);
            case "class":
                const { token } = (0, createSchema_js_1.getSchemaToken)(parameters[0], options);
                (0, di_1.registerProvider)({
                    provide: token,
                    deps: [],
                    useFactory() {
                        return (0, createSchema_js_1.getSchema)(parameters[0], options);
                    }
                });
                break;
        }
    };
}
exports.Schema = Schema;
function MongooseSchema(options = {}) {
    return Schema(options);
}
exports.MongooseSchema = MongooseSchema;
//# sourceMappingURL=schema.js.map